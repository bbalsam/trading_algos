#================================================================
#VERSION
#================================================================
#00.00			Original basic download with tweaking and working proof of concept.
#00.01			Testing to upload data to database.
#00.02			Upload to database confirmed. Added log file for error reporting, and error bypass.
#00.03			Create key handling for SQL upload.
#00.04			Fix download bug.
#00.05			Previous long time prod, slight differentces to version 00.04
#00.06			Add time specific execution.
#================================================================

import datetime
import yfinance as yf
import pandas as pd
import pyodbc
import time

from datetime import datetime, timedelta
from pandas_datareader import data as pdr
from datetime import date

#================================================================
#Code to allow time specific execution
#================================================================

# starttime = '04:00:00'
# endtime = '05:00:00'
# rest = 900 #900 = 15 minutes

# currtime = time.strftime('%H:%M:%S')

# while currtime < starttime or currtime > endtime :
	# print('Not yet...')
	# print(currtime)
	# time.sleep(rest)
	# currtime = time.strftime('%H:%M:%S')

# print(currtime)

#================================================================
#Code to allow Yahoo! to recognize API call
#================================================================
yf.pdr_override()


#================================================================
#Define variables
#================================================================
#date = datetime.date.today()
year = str(datetime.now().year)
month = str(datetime.now().month)
day = str(datetime.now().day)
timestamp = time.strftime('%H%M%S')
today = date.today()

while len(month) < 2:
	month = '0' + month

while len(day) < 2:
	day = '0' + day

#===============================================
#Error log file
#===============================================

logfilelocation = r'C:\Users\brett\OneDrive\Documents\Excel\Trading\PyProject\ErrorReports\\'
print('Logfilelocation: ' + logfilelocation)

logfilename = str(year + month + day +  '_' + timestamp + '_ErrorReport.txt')
print('LogFileName: ' + logfilename)

logfile = logfilelocation + logfilename
print('LogFile: ' + logfile)

ErrorLog = '=================================================================================================\r\n' + 'JOB FAILURES:\r\n'  + '=================================================================================================\r\n'

f = open(logfile,'a+')
f.write(ErrorLog)

#===============================================
#New code configured from: https://reasonabledeviations.com/2018/02/01/stock-price-database/#database-schema
#===============================================

conn = pyodbc.connect(DRIVER='{SQL Server}',SERVER='LAPTOP-D6TKOBQR\SQLEXPRESS',DATABASE='stockdb',Trusted_connection='yes')
crsr = conn.cursor()

# Tickers list
# We can add and delete any ticker from the list to get desired ticker live data


ticker_list=['A','AA','AAC','AAIC','AAL','AAMC','AAME','AAN','AAOI','AAON','AAP','AAT','AAWW','AAXN','AB','ABBV','ABC','ABCB','ABCL','ABCP','ABEO','ABG','ABIO','ABMC','ABQQ','ABR','ABT','ABTX','AC','ACA','ACAD','ACBI','ACC','ACCA','ACCO','ACER','ACFN','ACGL','ACHV','ACI','ACIW','ACLS','ACLZ','ACM','ACNB','ACOR','ACRE','ACRL','ACRS','ACRT','ACRX','ACTG','ACU','ACUR','ACXM','ACY','ADAP','ADAT','ADBE','ADC','ADES','ADFS','ADI','ADIL','ADM','ADMA','ADMD','ADMQ','ADMS','ADNT','ADOM','ADPT','ADS','ADSW','ADT','ADTN','ADUS','ADVM','ADXS','AE','AEGN','AEL','AEO','AER','AERI','AERO','AES','AESE','AEY','AEYE','AFBI','AFG','AFGR','AFH','AFI','AFIB','AFIN','AFL','AFRM','AFSI','AG','AGCB','AGE','AGEN','AGFS','AGII','AGIO','AGLE','AGM','AGN','AGNC','AGO','AGR','AGRX','AGS','AGTX','AGX','AGYS','AHC','AHCO','AHH','AHP','AHT','AI','AIG','AIM','AIMC','AIMT','AINC','AIPT','AIRG','AIRI','AIRT','AIT','AIV','AIVN','AIZ','AJG','AKAM','AKAO','AKBA','AKCA','AKR','AKRO','AKRX','AKS','AKTS','AKUS','AL','ALAC','ALB','ALBO','ALCO','ALDR','ALDW','ALDX','ALEC','ALEX','ALG','ALGN','ALGS','ALGT','ALIM','ALJJ','ALK','ALKS','ALLE','ALLK','ALLO','ALLY','ALNA','ALNY','ALOT','ALQA','ALRN','ALRS','ALRT','ALSK','ALSN','ALT','ALTA','ALTD','ALTG','ALTM','ALVR','ALXN','ALXO','AMAG','AMAR','AMBC','AMBR','AMC','AMCI','AMCR','AME','AMED','AMEH','AMG','AMH','AMHG','AMID','AMK','AMKR','AMNB','AMNL','AMOT','AMP','AMPE','AMPH','AMR','AMRB','AMRC','AMRH','AMRK','AMRN','AMRS','AMRX','AMSC','AMSF','AMST','AMSWA','AMTB','AMTD','AMTI','AMTX','AMWD','AMZN','AN','ANAT','ANCX','ANDE','ANDR','ANDX','ANF','ANGI','ANGO','ANH','ANIK','ANIP','ANIX','ANNX','ANTB','ANTH','ANTM','ANW','ANY','AOBC','AON','AOSL','AOUT','AP','APA','APC','APCN','APD','APDN','APEN','APGI','APLE','APLS','APLT','APO','APOG','APPN','APPS','APRE','APRI','APRN','APT','APTO','APTS','APTV','APTX','APVO','APY','APYP','APYX','AQB','AQMS','AQST','AQUA','AQXP','AR','ARAV','ARAY','ARC','ARCH','ARCI','ARCK','ARCT','ARCW','ARDX','ARES','AREX','ARGO','ARI','ARL','ARLO','ARLP','ARLZ','ARMK','ARMP','ARNA','ARNC','AROC','AROW','ARPO','ARQL','ARQT','ARR','ARRS','ARRY','ARTL','ARTW','ARTX','ARVN','ARW','ARYB','ASAQ.','ASB','ASCMA','ASFI','ASGN','ASH','ASIX','ASMB','ASNB','ASNS','ASPN','ASPS','ASPU','ASRT','ASRV','AST','ASTE','ASUR','ASV','ASX','ASYS','AT','ATACU','ATAX','ATCX','ATEA','ATEC','ATEX','ATGE','ATH','ATHA','ATHN','ATHX','ATI','ATKR','ATLC','ATLO','ATMS','ATNF','ATNM','ATNX','ATO','ATOM','ATOS','ATR','ATRC','ATRI','ATRO','ATSG','ATUS','ATVI','ATXI','AUB','AUBN','AUGX','AUMN','AUPH','AUSI','AUTO','AUXO','AVCO','AVCT','AVD','AVDL','AVDR','AVEO','AVGO','AVHI','AVID','AVIR','AVNS','AVO','AVP','AVT','AVX','AVXL','AVY','AVYA','AWK','AWRE','AX','AXAS','AXDX','AXE','AXGN','AXGT','AXL','AXLA','AXNX','AXON','AXP','AXR','AXS','AXSM','AXTA','AYI','AYLA','AYTU','AYX','AZO','AZYO','AZZ','B','BA','BABY','BAC','BAMM','BANC','BANF','BANR','BAS','BASA','BASI','BATRA','BAX','BAYK','BB','BBBY','BBCP','BBGI','BBI','BBIO','BBLG','BBOX','BBQ','BBSI','BBT','BBW','BBX.B','BC','BCACU','BCBP','BCC','BCDA','BCEI','BCEL','BCLI','BCML','BCO','BCOR','BCOV','BCOW','BCPC','BCRX','BCTF','BCTG','BCYC','BCYP','BDC','BDGE','BDMS','BDR','BDTX','BDX','BE','BEBE','BECN','BELFB','BERY','BETR','BFA','BFAM','BFC','BFGC','BFGCD','BFI','BFIN','BFS','BFST','BFT','BG','BGCP','BGFT','BGFV','BGG','BGNE','BGS','BGSF','BH','BH.A','BHB','BHBK','BHC','BHE','BHF','BHGE','BHLB','BHR','BHTG','BHVN','BICX','BID','BIEI','BIG','BIIB','BIOA','BIOL','BIVI','BIVV','BJ','BJRI','BK','BKD','BKE','BKEP','BKGM','BKH','BKI','BKJ','BKR','BKS','BKSC','BKTI','BKU','BKYI','BLCM','BLDR','BLFS','BLIN','BLK','BLL','BLMN','BLMT','BLNK','BLPH','BLUA','BMCH','BMNM','BMRA','BMRC','BMRG','BMRN','BMTC','BMY','BNED','BNFT','BNKL','BNL','BNXR','BOCH','BOH','BOKF','BOLD','BOLT','BOMN','BOOM','BOOT','BOTJ','BOXL','BPFH','BPL','BPMP','BPMX','BPOP','BPR','BPYU','BRBS','BREW','BRG','BRID','BRK.A','BRKA','BRKL','BRKR','BRMK','BRN','BRO','BRP','BRPM','BRS','BRT','BRTX','BRX','BRY','BSBK','BSET','BSGM','BSIG','BSM','BSPK','BSQR','BSRR','BSTG','BSTN','BSVN','BTAI','BTAQ.','BTHT','BTN','BTU','BTWNU','BTX','BUKS','BURG','BUSE','BV','BVSN','BW','BWA','BWB','BWEN','BWFG','BWINA','BWINB','BWLD','BWMC','BWP','BWXT','BXC','BXG','BXMT','BXP','BXRX','BXS','BY','BYD','BYND','BZH','C','CAAS','CABA','CABO','CAC','CACC','CACI','CADE','CAG','CAI','CAKE','CAL','CALA','CALB','CALI','CALL','CALM','CALX','CAMP','CANB','CANN','CAPL','CAPN','CAPR','CAR','CARA','CARB','CARE','CARO','CARR','CARS','CART','CARV','CAS.U','CASA','CASC','CASH','CASI','CASS','CASY','CAT','CATC','CATM','CATO','CATS','CATY','CB','CBAH','CBAK','CBAN','CBAT','CBAY','CBB','CBFV','CBIO','CBK','CBKC','CBKM','CBL','CBMG','CBNK','CBOE','CBRE','CBRI','CBRL','CBT','CBTX','CBU','CC','CCB','CCBG','CCCC','CCCR','CCEL','CCI','CCK','CCL','CCLP','CCNC','CCNE','CCNI','CCO','CCOI','CCR','CCRN','CCUR','CCXX','CDE','CDEV','CDLX','CDMO','CDNA','CDOR','CDR','CDTI','CDTX','CDXC','CDXS','CDZI','CECE','CECO','CEIX','CELC','CELG','CELH','CELP','CEMI','CENT','CENX','CEQP','CERC','CERE','CERF','CERN','CERS','CERT','CETX','CETY','CF','CFB','CFBI','CFBK','CFFA','CFFI','CFFN','CFG','CFI','CFIV','CFMS','CFOO','CFR','CFRX','CFX','CG','CGEI','CGEM','CGIX','CHAP','CHCO','CHCR','CHCT','CHD','CHDN','CHE','CHEF','CHFC','CHFS','CHFW','CHGG','CHK','CHKE','CHMA','CHMG','CHMI','CHNG','CHRA','CHRW','CHS','CHSCO','CHSCP','CHSP','CHTR','CHUY','CHWY','CHX','CI','CIA','CIGI','CIM','CINF','CINR','CIO','CIT','CIVB','CIVBP','CIX','CJ','CKH','CKPT','CKX','CLA','CLAR','CLB','CLBK','CLBS','CLCN','CLDB','CLDR','CLDT','CLDX','CLF','CLFD','CLGX','CLH','CLI','CLIR','CLMT','CLNC','CLNE','CLNS','CLNY','CLOK','CLOQ','CLPR','CLR','CLRB','CLRO','CLSD','CLSN','CLUB','CLVS','CLW','CLX','CLXT','CMBM','CMC','CMCT','CMD','CME','CMG','CMGO','CMIA','CMO','CMP','CMPI','CMPR','CMRO','CMRX','CMT','CMTV','CMXC','CNA','CNACU','CNBKA','CNC','CNCE','CNCG','CNDT','CNFN','CNFR','CNIG','CNK','CNMD','CNNB','CNNE','CNO','CNOB','CNP','CNR','CNSL','CNSP','CNST','CNTY','CNX','CNXC','CNXM','CODA','CODI','CODX','COFS','COG','COGT','COHN','COHU','COLB','COLD','COLL','COMM','CONE','CONN','COO','COOL','COOP','COP','CORE','CORI','CORN','CORR','CORT','COSM','COST','COT','COTY','COUP','COWN','CPAA','CPAH','CPB','CPE','CPF','CPFH','CPHC','CPIX','CPK','CPKA','CPLG','CPRI','CPRX','CPS','CPSI','CPSS','CPST','CPT','CPTP','CQH','CQP','CR','CRBO','CRBP','CRC','CRCM','CRDA','CRDA.','CRDAC','CRDF','CREE','CRGS','CRHM','CRI','CRIS','CRK','CRL','CRM','CRMD','CRMT','CRMZ','CRNX','CROL','CROX','CRR','CRS','CRSP','CRSS','CRTD','CRTX','CRVP','CRVS','CRVW','CRWS','CRY','CRZO','CSBB','CSBR','CSFL','CSII','CSL','CSLT','CSOD','CSPR','CSRA','CSS','CSSE','CSTL','CSTR','CSU','CSV','CSWI','CSX','CTACU','CTAM','CTB','CTBI','CTDH','CTEK','CTG','CTGO','CTHR','CTIB','CTIC','CTL','CTLT','CTMX','CTO','CTRA','CTRE','CTRN','CTRV','CTS','CTSH','CTSO','CTT','CTVA','CTXR','CUB','CUBI','CUE','CUEN','CUI','CUK','CULP','CUO','CUR','CURI','CURO','CURR','CUTR','CUZ','CVA','CVBF','CVCY','CVEO','CVET','CVGW','CVIA','CVLB','CVLY','CVM','CVNA','CVO','CVON','CVRS','CVS','CVSI','CVTI','CVV','CVX','CW','CWAY','CWBC','CWBR','CWCO','CWEN','CWGL','CWH','CWST','CWT','CXDC','CXDO','CXO','CXP','CXW','CY','CYAN','CYBE','CYCC','CYCN','CYDY','CYH','CYRX','CYTH','CYTK','CZFC','CZFS','CZNC','CZR','CZWI','D','DAIO','DAKT','DAL','DAR','DARE','DASH','DAVE','DBD','DBI','DBX','DCAR','DCI','DCO','DCOM','DCP','DCPH','DCTH','DDD','DDE','DDMX','DDOG','DDR','DDS','DEA','DECK','DEI','DELL','DEPO','DERM','DEST','DF','DFBG','DFBH','DFFN','DFH','DFIN','DFRG','DFS','DG','DGICA','DGICB','DGII','DGSE','DHCP','DHIL','DHR','DHX','DIN','DIOD','DIS','DISCA','DISH','DK','DKL','DKS','DLA','DLHC','DLPH','DLPN','DLR','DLTH','DLTR','DLX','DLYT','DMAC','DMLP','DMPI','DMRC','DMS','DMTK','DNB','DNBF','DNLI','DNMR','DNOW','DNP','DNR','DO','DOC','DOMO','DOOR','DORM','DOTAU','DOV','DOVA','DOW','DPDM','DPDW','DPLO','DPW','DRAD','DRE','DRH','DRI','DRIO','DRNA','DRRX','DRTT','DRVN','DS','DSKE','DSKX','DSNY','DSPG','DSS','DSSI','DST','DTE','DTIL','DTRC','DTRM','DUK','DUOT','DVA','DVAX','DVCR','DVMT','DVN','DWDP','DWSN','DX','DXC','DXCM','DXLG','DXPE','DXR','DXYN','DY','DYN','DYNT','DYSL','DZSI','E','EAF','EAGL','EAR','EARN','EAST','EAT','EBAY','EBC','EBF','EBIX','EBMT','EBSB','EBTC','ECA','ECIA','ECL','ECOL','ECOM','ECOR','ECPG','ECYT','ED','EDGE','EDGW','EDIT','EDNT','EDR','EDSA','EDUC','EEFT','EEI','EEX','EFC','EFOI','EFR','EFSC','EFSI','EGBN','EGC','EGHT','EGLE','EGN','EGRX','EGY','EHC','EHTH','EIDX','EIG','EIGI','EIGR','EKSO','ELA','ELAN','ELF','ELGX','ELLH','ELOX','ELSE','ELST','ELVT','ELY','ELYS','EMAN','EMCF','EME','EMES','EMGC','EMKR','EML','EMMA','EMN','EMPR','EMR','EMYB','ENB','ENBL','ENBP','ENDP','ENDV','ENFC','ENG','ENH','ENLC','ENOB','ENPH','ENR','ENRT','ENSG','ENSV','ENT','ENTL','ENV','ENVA','ENZ','ENZN','EOLS','EOSE','EPAC','EPAY','EPC','EPD','EPE','EPM','EPR','EPRT','EPSN','EPWR','EPZM','EQBK','EQC','EQFN','EQGP','EQH','EQIX','EQM','EQS','EQT','ERA','ERESU','ERI','ERIE','ERII','ES','ESCA','ESCC','ESDI','ESGR','ESI','ESL','ESNC','ESNT','ESOA','ESP','ESPR','ESQ','ESRT','ESRX','ESSA','ESSC','ESTA','ESTE','ESXB','ET','ETE','ETFC','ETFM','ETH','ETM','ETN','ETNB','ETON','ETP','ETRN','ETSY','ETTX','EV','EVA','EVBN','EVC','EVEP','EVER','EVFM','EVH','EVHC','EVLO','EVLV','EVOK','EVOL','EVOP','EVR','EVRG','EVRI','EVV','EWBC','EXA','EXAD','EXAS','EXC','EXDI','EXLS','EXNT','EXPE','EXPI','EXTN','EXTR','EXXI','EXXP','EYE','EYEG','EYEN','EYES','EYPT','EZPW','F','FAC','FACP','FAF','FALC','FANG','FARM','FAST','FAT','FATE','FAX','FBC','FBIO','FBIZ','FBK','FBM','FBMS','FBNC','FBNK','FBRC','FBSS','FC','FCAP','FCAX','FCBC','FCBP','FCCO','FCCY','FCEA.','FCEL','FCF','FCFS','FCNCA','FCPT','FCSC','FCX','FDBC','FDC','FDEF','FDMT','FDX','FE','FEIM','FENC','FET','FF','FFBC','FFBW','FFIC','FFIN','FFKT','FFNW','FFWM','FG','FGBI','FGEN','FGNA','FGP','FH','FHB','FHCO','FHI','FHN','FHTX','FI','FIBK','FICO','FII','FIS','FISI','FISV','FIT','FITB','FIX','FIXX','FIZZ','FKCB','FKYS','FL','FLAC','FLDM','FLEX','FLGT','FLIC','FLL','FLLCU','FLLF','FLML','FLMN','FLNT','FLO','FLR','FLS','FLT','FLUX','FLXN','FLXS','FMAO','FMBH','FMBI','FMBM','FMC','FMCB','FMCIU','FMFG','FMI','FMNB','FMSA','FMTX','FN','FNB','FNBG','FNCB','FND','FNF','FNGN','FNKO','FNLC','FNRN','FNTE','FNWB','FOCS','FOE','FOLD','FOMX','FOR','FORD','FORR','FOSL','FOX','FOXF','FPAY','FPH','FPI','FPRX','FPT','FRAF','FRAN','FRBK','FRD','FRED','FREE','FREQ','FREVS','FRG','FRGA','FRGI','FRHC','FRLF','FRME','FRPH','FRPT','FRSH','FRTA','FRXX','FSB','FSEA','FSFG','FSLR','FSLY','FSNN','FSP','FSRVU','FSS','FSTR','FTAI','FTDR','FTEK','FTI','FTK','FTLF','FTNT','FTNW','FTR','FTSI','FTSV','FTV','FUBO','FUL','FULC','FULT','FUN','FUNC','FUSB','FUSN','FUV','FVAC','FVCB','FVRG','FVT','FXNC','FZMD','GABC','GAIA','GALT','GASS','GATO','GAXY','GBCI','GBCS','GBIO','GBL','GBLI','GBNK','GBT','GBX','GCAP','GCBC','GCI','GCO','GCP','GD','GDEN','GDI','GDOT','GDP','GDYN','GE','GEC','GEF','GEL','GEO','GEOS','GER','GERN','GES','GEVO','GFED','GFF','GFN','GH','GHC','GHL','GHM','GIFI','GIGM','GIII','GIK.U','GIS','GIX.U','GKIT','GLA','GLBZ','GLDD','GLFH','GLFO','GLGI','GLOW','GLP','GLPI','GLPW','GLRE','GLSI','GLT','GLTO','GLW','GLXZ','GLYC','GLYE','GM','GME','GMED','GMO','GMRE','GMS','GNBC','GNC','GNCA','GNE','GNL','GNLN','GNMK','GNMX','GNPX','GNSS','GNTX','GNTY','GNUS','GO','GOEV','GOGO','GOLF','GOOD','GORO','GOSS','GOVX','GPC','GPI','GPK','GPMT','GPN','GPOR','GPP','GPRE','GPRO','GPS','GPT','GPV','GPX','GQM','GRA','GRAY','GRBK','GRC','GRCYU','GRIF','GRMN','GRMS','GROW','GRPN','GRTX','GRUB','GRWC','GRWG','GSAH','GSAT','GSB','GSBC','GSHD','GSIT','GSKY','GST','GT','GTE','GTES','GTHX','GTIM','GTLS','GTN','GTS','GTT','GTX','GTX.G','GTXI','GTY','GTYH','GURE','GUT','GV','GVA','GVP','GWB','GWR','GWRE','GWRS','GWTI','GWW','GYRO','HA','HABT','HAE','HAFC','HAIN','HAL','HALL','HALO','HARP','HAS','HASI','HAWK','HAYN','HBAN','HBB','HBCP','HBHC','HBI','HBIA','HBIO','HBMD','HBNC','HBP','HBT','HCA','HCAP','HCC','HCCH','HCCI','HCCO','HCCOU','HCDI','HCFT','HCHC','HCI','HCN','HCP','HCR','HD','HDNG','HDS','HDSN','HDYN','HE','HEAR','HEB','HEBT','HEES','HEI','HEP','HEPA','HES','HESM','HF','HFBC','HFBL','HFC','HFFG','HFWA','HGBL','HGEN','HGV','HHC','HHS','HI','HIBB','HICKA','HIG','HIHO','HII','HIIQ','HIL','HIVE','HIW','HJLI','HK','HL','HLF','HLIT','HLND','HLNE','HLS','HLTH','HLWD','HLX','HLXA','HLYK','HMG','HMHC','HMNF','HMST','HMSY','HMTA','HNGR','HNNA','HNRG','HOFD','HOFT','HOFV','HOG','HOLX','HOMB','HOME','HONE','HOOK','HOPE','HOS','HOTR','HP','HPHW','HPP','HPQ','HPR','HPTO','HQI','HR','HRB','HRC','HRI','HRL','HRMN','HRMY','HROW','HRTG','HRTH','HRTX','HSAC','HSAQ','HSC','HSDT','HSGX','HSII','HSKA','HSON','HST','HSY','HT','HTA','HTBI','HTBK','HTH','HTLD','HTLF','HTLFP','HTZ','HUBB','HUBS','HUM','HUN','HURC','HUSA','HVBC','HVT','HWBK','HWC','HWCC','HWKN','HXL','HY','HYDI','HYFM','HYMC','HYRE','HZN','HZNP','IAC','IAIC','IAMXU','IART','IBAL','IBCP','IBIO','IBKC','IBM','IBOC','IBTX','ICAD','ICBK','ICCC','ICCH','ICD','ICFI','ICHR','ICOX','ICPT','ICPW','ICTSF','ICUI','IDA','IDGS','IDN','IDRA','IDSY','IDT','IDTI','IDTY','IDXX','IDYA','IEA','IEC','IEHC','IEP','IESC','IFF','IFLM','IFMK','IGEN','IGMS','IGSC','IGXT','IHRC','IHRT','IHTM','III','IIIN','IIIV','IIPR','IIVI','IKNX','ILAL','IMAC','IMAHF','IMAX','IMCI','IMDZ','IMGN','IMH','IMI','IMKTA','IMMD','IMMR','IMMU','IMNM','IMNP','IMRA','IMTL','IMUX','IMVT','IMXI','INAP','INBK','INBX','INCY','INDB','INFI','INFN','INFO','INFU','INGN','INGR','INLX','INMB','INN','INNT','INNV','INO','INOD','INOV','INS','INSE','INSG','INSM','INSP','INST','INSY','INT','INTC','INTI','INTL','INTT','INTV','INTX','INUV','INVA','INVE','INVH','INWK','INZY','IO','IOSP','IOTS','IOVA','IP','IPAS','IPDN','IPG','IPI','IPWR','IQV','IRDM','IRET','IRIX','IRLD','IRNC','IROQ','IRT','ISBA','ISBC','ISCA','ISCO','ISDR','ISEE','ISIG','ISNS','ISR','ISSC','ISTR','IT','ITCI','ITHX','ITI','ITNM','ITOS','ITRI','ITRM','ITUS','ITW','IVAC','IVC','IVFH','IVR','IVTY','IVZ','IWSH','IWSY','IZEA','JACK','JAG','JAGX','JAKK','JAMF','JANL','JASN','JAX','JAZZ','JBGS','JBHT','JBLU','JBT','JCAP','JCI','JCOM','JCP','JCS','JDSA','JEC','JEF','JELD','JFKKU','JILL','JJSF','JKHY','JMBA','JMDA','JMP','JNCE','JNJ','JNP','JOB','JOE','JPM','JRVR','JSDA','JUNO','JUVF','JVA','JWA.J','JWSM','JXSB','JYNT','K','KALA','KALV','KAMN','KAR','KAVL','KBAL','KBLMU','KBR','KDMN','KDNY','KDOZF','KDP','KDUS','KEG','KELYA','KEM','KEQU','KEX','KEY','KEYW','KFFB','KFS','KFY','KHC','KIDS','KIDZ','KIM','KIN','KINS','KIRK','KITE','KKR','KLDO','KLDX','KLIC','KLXE','KMB','KMG','KMI','KML','KMPH','KMPR','KMT','KMX','KN','KNDI','KNL','KNSA','KNSL','KNTE','KNWN','KNX','KO','KOD','KODK','KONA','KOOL','KOP','KOPN','KOS','KOSS','KPTI','KR','KRA','KREF','KRG','KRMD','KRNY','KRO','KRON','KROS','KRP','KRTX','KRYS','KS','KSF','KSHB','KSS','KSU','KTB','KTCC','KTEC','KTEL','KTOS','KTRA','KTYB','KURA','KVHI','KW','KXIN','KYN','KZR','LABL','LABP','LAD','LADR','LAMR','LAND','LARK','LAUR','LAWS','LAYN','LAZY','LB','LBAI','LBC','LBRT','LBTY','LBY','LC','LCAP','LCI','LCII','LCNB','LCTX','LCUT','LDOS','LE','LEAF','LEAI','LEGH','LEMT','LEVI','LEVL','LFER','LFUS','LFVN','LGCY','LGF','LGF.B','LGIH','LGIQ','LGL','LGND','LHO','LHX','LIFE','LII','LILA','LIN','LINC','LIND','LINK','LION','LIQT','LIVC','LIVE','LIVN','LIVX','LIXT','LJPC','LKFN','LKQ','LKSD','LL','LLEX','LLNW','LLY','LMACA','LMAT','LMB','LMFA','LMNR','LMNX','LMPX','LMRK','LMST','LMT','LNC','LNCE','LNDC','LNG','LNSR','LNT','LOAN','LOB','LODE','LOGC','LOGM','LONE','LOOP','LOPE','LOV','LOVE','LOW','LPCN','LPG','LPI','LPNT','LPTH','LPTX','LPX','LQDA','LQDT','LRAD','LRY','LSBK','LSCC','LSF','LSI','LSXMA','LSXMK','LSYN','LTBR','LTC','LTHM','LTN','LTRE','LTRX','LTS','LTXB','LUB','LULU','LUNG','LUV','LUVU','LVGO','LVS','LW','LWAY','LXFR','LXRX','LXU','LYB','LYFT','LYRA','LYTS','LYV','M','MA','MAA','MAC','MACK','MAGE','MAMS','MAN','MANT','MAR','MARA','MASS','MAT','MATN','MATR','MATW','MATX','MAXD','MAXR','MAYS','MB','MBCN','MBCQ','MBI','MBII','MBIN','MBIO','MBOT','MBRX','MBTF','MCACU','MCADU','MCB','MCBC','MCD','MCEP','MCF','MCFT','MCHP','MCHX','MCO','MCOA','MCRB','MCRN','MCS','MCY','MD','MDB','MDCA','MDCL','MDCO','MDGL','MDIA','MDIT','MDLA','MDLY','MDLZ','MDP','MDR','MDRR','MDRX','MDSY','MDSYF','MDT','MDU','MDVL','MDVX','MDWT','MEC','MED','MEEC','MEET','MEG','MEI','MEIP','MELI','MERC','MESA','MET','METC','MFA','MFCO','MFIN','MFNC','MFON','MFST','MG','MGEE','MGEN','MGM','MGP','MGPI','MGTA','MGTI','MGTX','MGY','MGYR','MHK','MHLD','MIC','MICR','MIDD','MIND','MINI','MIRM','MIST','MITL','MITT','MJCO','MKC','MKGI','MKL','MKTY','MLHR','MLI','MLM','MLNT','MLNX','MLSS','MLVF','MMAC','MMC','MMLP','MMM','MMP','MMSI','MN','MNCL','MNGA','MNI','MNK','MNKD','MNLO','MNOV','MNPR','MNR','MNRL','MNRO','MNSB','MNTR','MNTX','MO','MOBL','MOD','MODD','MOFG','MOGA.','MOH','MOMT','MORF','MOS','MOSC','MOSY','MOTS','MPAA','MPB','MPC','MPLN','MPLX','MPO','MPW','MPX','MR','MRAM','MRBK','MRC','MRCY','MRDN','MRIC','MRIN','MRKR','MRLN','MRNA','MRNS','MRO','MRSN','MRT','MRTN','MRTX','MRUS','MRVI','MRVL','MS','MSB','MSBF','MSBI','MSFG','MSFT','MSL','MSLP','MSM','MSON','MSP','MSRT','MSTR','MSVB','MTB','MTBC','MTCR','MTDR','MTEM','MTEX','MTG','MTGE','MTH','MTN','MTNB','MTOR','MTRN','MTRX','MTSC','MTSI','MTSL','MTST','MTW','MTX','MUR','MUSA','MUX','MVBF','MVIS','MWA','MWBC','MWK','MX','MXC','MXL','MXWL','MYAN','MYE','MYFW','MYGN','MYL','MYND','MYO','MYOK','MYOS','MYOV','MYRG','N.A.','NA','NAC','NANX','NARI','NATI','NATR','NAV','NAVB','NAVI','NBEV','NBL','NBLX','NBN','NBR','NBRV','NBSE','NBTB','NC','NCBS','NCMI','NCNO','NCOM','NCR','NCS','NCSM','NDRA','NDSN','NE','NEE','NEN','NEOG','NEON','NEOS','NEP','NEPH','NERV','NES','NESR','NEU','NEWM','NEWR','NFBK','NFE','NFJ','NFLX','NFX','NG','NGHC','NGL','NGM','NGTF','NGVC','NGVT','NHC','NHI','NHLD','NI','NICK','NIHD','NINE','NIOBF','NJMC','NK','NKE','NKLA','NKSH','NKTK','NKTR','NKTX','NL','NLNK','NLS','NLSN','NLTX','NLY','NMGX','NMIH','NMMC','NMRK','NMRX','NMTR','NNBR','NNI','NNN','NNUP','NNUTD','NNUTU','NOA','NODK','NOG','NOV','NOVA','NOVN','NOW','NP','NPK','NPO','NPS','NPTN','NR','NRCG','NRE','NREF','NRG','NRIM','NRT','NRZ','NS','NSA','NSC','NSCO','NSEC','NSH','NSIT','NSM','NSP','NSPR','NSRC','NSTG','NSYS','NTEC','NTG','NTGR','NTIC','NTN','NTRP','NTST','NTWK','NURO','NUS','NUVA','NVAX','NVCR','NVDA','NVEE','NVGI','NVIV','NVLN','NVLNF','NVLS','NVMM','NVR','NVRO','NVT','NVTA','NVTR','NVUS','NWBI','NWE','NWFL','NWGI','NWHM','NWIN','NWL','NWN','NWPP','NWPX','NWS','NWY','NX','NXEO','NXGN','NXPI','NXRT','NXST','NXTC','NYC','NYCB','NYLD','NYMOX','NYMT','NYMX','NYNY','NYRT','NYSE','NYSE.','OAK','OAKS','OAS','OB','OBLG','OBLN','OBNK','OC','OCC','OCFC','OCGN','OCIP','OCN','OCRX','OCSI','OCSL','OCUL','OCX','ODC','ODP','ODT','OEC','OEG','OESX','OFC','OFG','OFIX','OGE','OGEN','OGS','OHI','OHRP','OI','OII','OIS','OKE','OKS','OLBG','OLBK','OLED','OLLI','OLMA','OLN','OLP','OM','OMAM','OMED','OMEG','OMEX','OMF','OMI','OMN','OMNT','OMP','OMTK','ONB','ONCR','ONCS','ONCT','ONDK','ONEW','ONTF','ONTX','ONVI','OOMA','OPBK','OPCH','OPCO','OPGN','OPHC','OPK','OPNT','OPOF','OPRT','OPRX','OPTN','OPTT','OPXS','OPY','ORA','ORBC','ORC','ORCL','ORGO','ORI','ORIT','ORLY','ORM','ORMP','ORN','ORRF','OSBC','OSG','OSIS','OSK','OSMT','OSPN','OSS','OSTK','OSUR','OSW','OTCQX','OTEL','OTIS','OTIV','OTIVF','OTLK','OTTW','OVBC','OVID','OVLY','OVTZ','OVV','OXBR','OXFD','OXM','OXY','OYST','OZRK','PAA','PAAC','PACD','PACK','PACQ','PACW','PAG','PAGP','PAH','PALT','PANA','PAND','PANL','PANW','PAOS','PAR','PARI','PARR','PASG','PATI','PATK','PAVM','PAYM','PAYX','PB','PBBI','PBCT','PBF','PBFX','PBH','PBHC','PBI','PBIB','PBIO','PBIP','PBPB','PCAR','PCB','PCG','PCH','PCLN','PCO','PCPL','PCRX','PCSB','PCTI','PCTY','PCVX','PCYG','PCYN','PCYO','PD','PDCE','PDCO','PDEX','PDLB','PDLI','PDM','PDVW','PE','PEB','PEBK','PEBO','PED','PEER','PEGA','PEGI','PEI','PEIX','PENC','PENN','PERS','PES','PESI','PETQ','PETV','PF','PFBI','PFBX','PFC','PFE','PFG','PFGC','PFHD','PFHO','PFHOD','PFIN','PFIS','PFMT','PFNX','PFS','PFSI','PFSW','PFTI','PGAS','PGC','PGEN','PGLC','PGNX','PGNY','PGR','PGRE','PGTI','PGTK','PGUS','PH','PHAS','PHAT','PHGE','PHII','PHIL','PHIO','PHM','PHOT','PHUN','PHX','PI','PICO','PIH','PII','PINE','PINS','PIPR','PIR','PIRS','PJT','PK','PKBK','PKD','PKG','PKOH','PKTX','PLAB','PLAG','PLAN','PLAY','PLBC','PLCE','PLNT','PLOW','PLPC','PLRM','PLSE','PLT','PLUG','PLX','PLXP','PLXS','PLYA','PLYM','PM','PMBC','PMD','PME','PMT','PMTS','PMVP','PNBK','PNC','PNFP','PNI','PNM','PNR','PNTG','POAI','PODD','POL','POPE','POST','PPBI','PPC','PPD','PPHM','PPSI','PQ','PQE','PQG','PRA','PRAA','PRAX','PRCP','PRED','PRFT','PRGO','PRGS','PRGX','PRIM','PRK','PRKA','PRKR','PRLD','PRLE','PRMW','PRNB','PROG','PROM','PROS','PROV','PRPH','PRPL','PRPO','PRSC','PRSI','PRSP','PRSS','PRTA','PRTH','PRTO','PRTS','PRTX','PRTY','PRU','PRVB','PRVL','PS','PSA','PSB','PSDO','PSDV','PSIX','PSN','PSNL','PSTB','PSTG','PSTI','PSTL','PSTV','PSTX','PSX','PSXP','PTCT','PTE','PTEN','PTGX','PTI','PTIE','PTLA','PTN','PTON','PTRS','PTVCA','PTVE','PTXP','PUB','PULM','PUMP','PURE','PVAC','PVBC','PVH','PVNC','PW','PWOD','PWON','PWR','PXD','PXLW','PYPL','PZG','PZN','PZZA','QADA','QBAK','QCOM','QCRH','QDEL','QEP','QES','QHC','QHYG','QLGN','QMCO','QNBC','QNTO','QPAG','QRHC','QRTEA','QSEP','QSII','QSP','QSR','QTM','QTNT','QTRX','QTS','QUAD','QUES','QUMU','QUOT','R','RADI','RAI','RAIL','RAMP','RAPT','RARE','RARX','RAS','RASF','RASFN','RASFO','RASFP','RASPR','RAVE','RAVN','RBA','RBB','RBBN','RBCAA','RBCN','RBKB','RBNC','RC','RCII','RCKT','RCKY','RCL','RCM','RCMT','RCUS','RDFN','RDGL','RDI','RDN','RDUS','RDVT','RE','REED','REFR','REG','REGI','REGN','REI','REIS','REKR','RELL','RELV','REN','REPL','REPR','RES','RESI','RESN','RETA','REV','REVG','REXR','REXX','REYN','REZI','RFIL','RFP','RGA','RGC','RGCO','RGLD','RGLS','RGNP','RGP','RGR','RGRX','RGS','RGSE','RGUS','RH','RHE.A','RHP','RIBT','RICK','RIG','RIGL','RILY','RIVE','RJF','RKDA','RKT','RL','RLAY','RLGT','RLGY','RLH','RLI','RLJ','RLJE','RLMD','RLOG','RM','RMAX','RMBI','RMBL','RMCF','RMED','RMES','RMGN','RMNI','RMTI','RNA','RNDB','RNET','RNGR','RNN','RNST','RNWK','ROAD','ROAN','ROCCU','ROCHU','ROCK','ROIC','ROL','ROP','ROSE','ROSG','ROX','RP','RPAI','RPAY','RPLA','RPM','RPT','RPTX','RRBI','RRC','RRD','RRGB','RRR','RRTS','RSG','RSLS','RSLSD','RSO','RSPI','RSPP','RSSS','RST','RSYS','RTIX','RTK','RTLR','RTN','RTNB','RTRX','RTTR','RTX','RUBI','RUBY','RUN','RVA.A','RVEN','RVI','RVLT','RVMD','RVNC','RVP','RVSB','RVSP','RWC','RWT','RXII','RXN','RYAM','RYES','RYESD','RYI','RYN','RYTM','RZLT','S','SABR','SACH','SAFE','SAFT','SAGE','SAH','SAIC','SAIL','SAL','SALM','SAMG','SANM','SANW','SASR','SAUC','SAVA','SAVE','SBAC','SBBP','SBBX','SBCF','SBCP','SBE.U','SBFG','SBGI','SBH','SBOW','SBPH','SBRA','SBSI','SBT','SBTB','SBTX','SBUX','SC','SCHW','SCI','SCIA','SCKT','SCL','SCMP','SCND','SCOO','SCOR','SCPH','SCPL','SCS','SCSC','SCVL','SCVX','SCX','SCY','SCYX','SD','SDC','SDGR','SDI','SDOI','SDOIA','SDPI','SEAC','SEAS','SEB','SEE','SEEL','SEER','SEIC','SELB','SELF','SEMG','SEND','SENEA','SENEB','SENS','SERV','SF','SFBC','SFBS','SFE','SFEF','SFM','SFNC','SFR','SFS','SFST','SFT','SG','SGA','SGB','SGBX','SGEN','SGH','SGLB','SGLDF','SGMA','SGMO','SGMS','SGRY','SGSI','SGTX','SGU','SHBI','SHEN','SHLD','SHLL','SHLX','SHO','SHOS','SHRG','SHSP','SHW','SI','SIAF.','SIBN','SIC','SIEN','SIF','SIG','SIGA','SIGI','SIGM','SIOX','SITC','SITE','SITM','SITO','SIX','SJI','SJM','SJW','SKIS','SKT','SKY','SKYL','SKYW','SLAB','SLB','SLCA','SLCT','SLDB','SLG','SLGD','SLGG','SLGN','SLNG','SLNO','SLP','SLPA','SLRX','SM','SMBC','SMBK','SMDM','SMED','SMG','SMGI','SMHI','SMID','SMIT','SMLP','SMMC','SMMF','SMPL','SMPR','SMRT','SMTA','SMTI','SMTX','SN','SNA','SNBP','SNBR','SNCR','SND','SNDR','SNDX','SNES','SNEX','SNGX','SNHY','SNMP','SNMX','SNNA','SNNF','SNOA','SNR','SNSS','SNV','SNWW','SNX','SNYR','SO','SOAN','SODI','SOFO','SOHO','SOHU','SOI','SOL','SOLY','SONA','SONC','SONM','SONN','SORL','SP','SPAR','SPB','SPCE','SPEX','SPFI','SPG','SPGI','SPH','SPHS','SPKE','SPLP','SPN','SPNE','SPOK','SPR','SPRB','SPRO','SPRT','SPTN','SPWH','SPWR','SQBG','SQZ','SR','SRACU','SRAX','SRC','SRCE','SRCH','SRCI','SRCL','SRE','SREV','SRG','SRGA','SRGZ','SRLP','SRMC','SRNA','SRNE','SRPT','SRRA','SRRK','SRRY','SRT','SSAA','SSB','SSBP','SSH','SSI','SSKN','SSNC','SSP','SSPK','SSTI','SSW','ST','STAA','STAF','STAG','STAR','STAY','STBA','STBZ','STC','STDY','STEP','STFC','STI','STIM','STKL','STKS','STL','STLD','STLY','STML','STMP','STND','STOK','STON','STOR','STQN','STRA','STRL','STRM','STRO','STRS','STS','STSA','STT','STTK','STVI','STWD','STX','STXB','SUI','SUM','SUME','SUMR','SUN','SUNW','SUP','SURF','SURG','SVBI','SVBL','SVFA','SVRA','SWAV','SWBK.','SWCH','SWET','SWI','SWK','SWKH','SWM','SWN','SWTF','SWTX','SWX','SXC','SXCP','SXT','SYBT','SYBX','SYF','SYK','SYMC','SYN','SYNC','SYNH','SYNL','SYNT','SYPR','SYRS','SYTE','T','TA','TACO','TACT','TAGS','TAIT','TALO','TAP','TAPM','TARA','TARS','TAST','TAT','TAUG','TAX','TAXA','TAYD','TBA','TBBK','TBIO','TBK','TBPH','TBTC','TCBI','TCBK','TCDA','TCF','TCFC','TCI','TCMD','TCO','TCON','TCRR','TCS','TCX','TDC','TDG','TDNT','TDS','TDW','TDY','TECH','TECR','TECTP','TEGP','TEKK','TEL','TELL','TEN','TENB','TENX','TEP','TERN','TERP','TESS','TEUM','TEVA','TEX','TFC','TFFP','TFSL','TFVR','TFX','TG','TGE','TGEN','TGRR','TGT','TGTX','TH','THC','THFF','THLD','THM','THMG','THO','THOR','THR','THRM','THS','TIF','TIK','TILE','TIME','TINY','TIPT','TIS','TISI','TITN','TIVO','TKAT','TKOI','TKR','TLF','TLGT','TLND','TLP','TLRA','TLRD','TLRS','TLRY','TLYS','TMDX','TMK','TMP','TMQ','TMRC','TMSR','TMST','TMTSU','TMUS','TNAV','TNDM','TNET','TNTY','TNXP','TOCA','TORC','TPB','TPC','TPCO','TPCS','TPGE','TPHS','TPIC','TPIV','TPL','TPR','TPRE','TPTX','TPX','TRC','TRCB','TREC','TREE','TRGP','TRHC','TRIN','TRIP','TRK','TRMK','TRMR','TRMT','TRN','TRNC','TRNF','TRNO','TRNS','TROV','TROX','TRS','TRST','TRTC','TRTN','TRTN.','TRTX','TRU','TRUP','TRV','TRVN','TRWH','TRXC','TSBK','TSC','TSCO','TSE','TSLA','TSN','TSQ','TSRI','TSRO','TSS','TST','TT','TTD','TTI','TTMI','TTNP','TTOO','TTPH','TTS','TUES','TUP','TURN','TUSK','TVPT','TVTY','TW','TWI','TWIN','TWLO','TWLVU','TWMC','TWNK','TWO','TWOU','TWTR','TXG','TXMD','TXRH','TYG','TYME','TZACU','TZOO','UA','UAA','UAL','UAN','UBA','UBCO','UBCP','UBER','UBFO','UBI','UBOH','UBP','UBSH','UBSI','UCBA','UCBI','UCFC','UCTT','UDR','UE','UEIC','UEPS','UFAB','UFCS','UFI','UFPI','UFS','UGHL','UGI','UHAL','UHT','UIHC','ULBI','ULH','ULTA','UMBF','UMH','UMRX','UNAM','UNB','UNFI','UNH','UNIR','UNIT','UNP','UNT','UNTY','UNVR','UNXL','UONE.','UPL','UPLC','UPLD','UPS','UPWK','UQM','URG','URGN','URI','UROV','USAC','USAK','USAP','USAT','USAU','USCR','USDP','USEL','USFD','USG','USIO','USLM','USPH','USWS','USX','UTG','UTGN','UTI','UTL','UUUU','UVE','UVSP','UWN','V','VABK','VAC','VALU','VAPO','VASO','VBFC','VBIV','VBTX','VC','VCNX','VCTR','VEC','VECO','VEII','VEL','VER','VERB','VERI','VERU','VERY','VFC','VG','VGAC.','VGR','VGZ','VHC','VHI','VIA','VIACA','VICA','VICI','VICL','VICR','VIE','VII','VINO','VIR','VIRC','VIRI','VIRT','VISI','VITL','VIVE','VIVO','VKTX','VLO','VLRX','VLTC','VLY','VMC','VNCE','VNE','VNOM','VNRX','VNTR','VOLT','VOR','VOXX','VOYA','VPG','VPRB','VRA','VRAY','VRCA','VREX','VRME','VRML','VRNS','VRRM','VRS','VRSK','VRT','VRTU','VRTV','VRTX','VRUS','VRX','VSAR','VSAT','VSEC','VSH','VSI','VSM','VST','VSTM','VSTO','VSTR','VSUL','VTGN','VTIQ','VTL','VTNR','VTOL','VTRS','VTSI','VTVT','VUZI','VVC','VVI','VVNT','VVOS','VVUS','VVV','VXEL','VXRT','VYGG','VYGR','VYNE','VYST','W','WAAS','WAB','WABC','WAFD','WAIR','WAL','WARM','WASH','WATT','WAYN','WBA','WBB','WBBW','WBS','WBT','WCC','WCFB','WCG','WCN','WCRS','WD','WDAY','WDFC','WEBK','WEIN','WELL','WEN','WERN','WES','WETF','WEYL','WEYS','WFC','WFCF','WFT','WG','WGO','WH','WHG','WHIR','WHLM','WHLR','WHLRD','WHR','WIFI','WIN','WINT','WISH','WIZD','WIZP','WK','WKHS','WLDN','WLFC','WLH','WLK','WLKP','WLL','WLMS','WLTW','WMB','WMC','WMGI','WMIH','WMK','WMLPQ','WMS','WNEB','WOLV','WOOF','WOR','WOW','WPC','WPF','WPF.U','WPG','WPT','WPX','WPZ','WRD','WRI','WRK','WRLD','WRTC','WSBC','WSC','WSFS','WSM','WSR','WST','WSTG','WSTL','WTBA','WTFC','WTI','WTM','WTR','WTRE','WTRG','WTRH','WTT','WTTR','WTW','WU','WVE','WVFC','WVVI','WWD','WWW','WY','WYIG','WYND','WYNN','WYY','X','XAIR','XAN','XBIT','XCUR','XDSL','XEC','XEL','XELA','XELB','XENE','XENT','XERS','XGN','XHR','XLRN','XNAFX','XNCR','XOM','XOMA','XON','XONE','XPER','XPL','XPLR','XPO','XRAY','XRM','XRX','XSPA','XSPL','XXII','Y','YAYO','YCBD','YEXT','YMAB','YORW','YRCW','YRIV','YSTR','YTEN','YUM','YUMA','YUMC','ZAGG','ZAIS','ZANDZ','ZAYO','ZBH','ZDGE','ZDPY','ZEUS','ZFGN','ZGNX','ZGYHU','ZION','ZIOP','ZIVO','ZMTP','ZNTL','ZOES','ZOM','ZRPTI','ZS','ZSAN','ZVO','ZYME','ZYNE','ZYXI','ZZLL','ATGE','ATLO','BBIO','BCBP','BKI','BMBL','CSTR','EMCF','GCBC','GTIM','HEPA','ILAL','NUS','NYC','ONCR','SCPS','SPLP','STBA','TWO','UMH','XAIR','ATEX','CAMP','CNBKA','CZFS','FSP','NWBI','NYC','OPK','PPBI','PWOD','QDEL','RBNC','SBSI','TDS','TPL','USLM','YORW']

ticker_list = ['GME']

# We can get data by our choice by giving days bracket
#start_date = datetime.datetime.strptime('2020–01–01','%Y-%m-%d')
#end_date= datetime.date(2020, 6, 26)#'2020–06–26'
#===============================================
#commented below for testing
#files=[]
#commented above for testing
#===============================================


def getData(ticker):
	#print(ticker)
	try:
		data = pdr.get_data_yahoo(ticker, start=today-timedelta(1000), end=today) #18000 in range
		#===============================================
		#commented below for testing
			#dataname= ticker+'_'+str(today)
			#files.append(dataname)
			#SaveData(data, dataname)
		#commented above for testing
		#===============================================
		# Create a data folder in your current dir.
		#===============================================
		#commented below for testing
		# def SaveData(df, filename):
			# df.to_csv('.\SANDPDownload\\'+filename+'.csv')
		#commented above for testing
		#===============================================
		#This loop will iterate over ticker list, will pass one ticker to get data, and save that data as file.
		#print(data)
		#===============================================
		#New code configured from: https://reasonabledeviations.com/2018/02/01/stock-price-database/#database-schema
		#===============================================
		for row in data.itertuples():
			values = list(row)
			values.append(ticker)
			newval = str(values[0])
			newval = newval.replace(' 00:00:00','')
			newval = newval.replace('-','')
			newval = (values[7] + '_' + newval)
			values.append(newval)
			try:
				crsr.execute("""INSERT INTO InsiderStocks (dtDate,decOpen,decHigh,decLow,decClose,decAdjClose,intVol,strTick,ID)
				VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)""",
				tuple(values))
				conn.commit()
			except Exception as e:
				try: 
					miscerr = miscerr + 'error: ' + str(newval) + str(e) + '\r\n'
				except:
					miscerr = 'error: ' + str(newval) + str(e) + '\r\n'
		#===============================================
	except Exception as e:
		ErrorLog = """'""" + str(ticker) + """'""" + ','
		f.write(ErrorLog)
		print(str(e))

for tik in ticker_list:
	timestamp = time.strftime('%H%M%S')
	print(tik + ' started at ' + str(timestamp))
	getData(tik)
	timestamp = time.strftime('%H%M%S')
	print(tik + ' completed at ' + str(timestamp))
	

ErrorLog = '\r\n'  + '================================================================================================='

f.write(ErrorLog)
try:
	f.write(miscerr)
except:
	print('No misc errors')
f.close()
print("""Job's done""")
